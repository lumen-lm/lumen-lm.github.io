import{d as j,r as s,o,c as r,w as f,v as A,a,b as F,e as k,F as g,f as x,g as S,t as b}from"./index-CxfTr-rM.js";import{F as w}from"./FileSaver.min-Xzu1HhCm.js";const L=a("label",{for:"checkbox"},"显示封面",-1),N=a("label",{for:"checkbox"},"中转下载",-1),B=["src"],R=["onClick"],q=["onClick"],D=a("span",null,"作者：",-1),E=["src"],C="https://oiapi.net/API/Music_163",O=j({__name:"MyView1",setup(K){const u=s(""),c=s(!1),v=s([]),I=s(""),i=s(),d=s(V()),M=async e=>{if(e.musicInfo){y(e.musicInfo.url);return}let n=await h(e.id);e.musicInfo=n,y(n.url)};async function h(e){let n=new URL(C);n.searchParams.append("id",e.toString());let l=(await fetch(n).then(p=>p.json())).data;if(l.length)return l[0];throw new Error("没有找到歌曲")}async function U(e){e.musicInfo||(e.musicInfo=await h(e.id));let n=e.musicInfo.url,t=n.substring(n.lastIndexOf(".")),l=m(e.name),p=m(e.singers[0].name);P(n,l+"-"+p+t)}function m(e){if(!e)return"";const n=/[\\/:*?"<>|]/g;return e.replace(n,"")}function y(e){i.value.src=e,i.value.oncanplay=()=>{i.value.oncanplay=null,i.value.play()}}function _(){if(!u.value||!u.value.trim())return;let e=new URL(C);e.searchParams.append("name",u.value),fetch(e).then(n=>n.json()).then(n=>{v.value=n.data})}function P(e,n){if(d.value){let t=new URL("https://1kbm67hp.objdump.cn");t.searchParams.append("targetUrl",e),w.saveAs(t.toString(),n)}else w.saveAs(e,n)}function V(){return/Mobi|Android|iPhone/i.test(navigator.userAgent)}return(e,n)=>(o(),r("main",null,[f(a("input",{onKeyup:F(_,["enter"]),type:"text","onUpdate:modelValue":n[0]||(n[0]=t=>u.value=t)},null,544),[[A,u.value]]),a("button",{onClick:_},"搜索"),a("div",null,[f(a("input",{type:"checkbox","onUpdate:modelValue":n[1]||(n[1]=t=>c.value=t)},null,512),[[k,c.value]]),L,f(a("input",{type:"checkbox","onUpdate:modelValue":n[2]||(n[2]=t=>d.value=t)},null,512),[[k,d.value]]),N]),a("div",null,[(o(!0),r(g,null,x(v.value,t=>(o(),r("div",{key:t.id},[c.value?(o(),r("img",{key:0,src:t.picurl,width:"100px",height:"100px",alt:"封面"},null,8,B)):S("",!0),a("span",null,b(t.name),1),a("a",{onClick:l=>M(t)},"播放",8,R),a("a",{onClick:l=>U(t)},"下载",8,q),D,(o(!0),r(g,null,x(t.singers,l=>(o(),r("span",{key:l.id},b(l.name),1))),128))]))),128))]),a("audio",{ref_key:"audio",ref:i,id:"audio",src:I.value,controls:""},null,8,E)]))}});export{O as default};
