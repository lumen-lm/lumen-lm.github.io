import{d as S,r as _,o as m,c as y,w as x,v as F,a as i,b as O,e as T,F as L,f as M,g as C,t as R}from"./index-D11utc5h.js";var g=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var A={exports:{}};(function(c,p){(function(v,d){d()})(g,function(){function v(n,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}function d(n,o,r){var e=new XMLHttpRequest;e.open("GET",n),e.responseType="blob",e.onload=function(){w(e.response,o,r)},e.onerror=function(){console.error("could not download file")},e.send()}function k(n){var o=new XMLHttpRequest;o.open("HEAD",n,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function u(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(o)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof g=="object"&&g.global===g?g:void 0,h=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),w=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(n,o,r){var e=l.URL||l.webkitURL,t=document.createElement("a");o=o||n.name||"download",t.download=o,t.rel="noopener",typeof n=="string"?(t.href=n,t.origin===location.origin?u(t):k(t.href)?d(n,o,r):u(t,t.target="_blank")):(t.href=e.createObjectURL(n),setTimeout(function(){e.revokeObjectURL(t.href)},4e4),setTimeout(function(){u(t)},0))}:"msSaveOrOpenBlob"in navigator?function(n,o,r){if(o=o||n.name||"download",typeof n!="string")navigator.msSaveOrOpenBlob(v(n,r),o);else if(k(n))d(n,o,r);else{var e=document.createElement("a");e.href=n,e.target="_blank",setTimeout(function(){u(e)})}}:function(n,o,r,e){if(e=e||open("","_blank"),e&&(e.document.title=e.document.body.innerText="downloading..."),typeof n=="string")return d(n,o,r);var t=n.type==="application/octet-stream",a=/constructor/i.test(l.HTMLElement)||l.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||t&&a||h)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var b=f.result;b=s?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),e?e.location.href=b:location=b,e=null},f.readAsDataURL(n)}else{var j=l.URL||l.webkitURL,E=j.createObjectURL(n);e?e.location=E:location.href=E,e=null,setTimeout(function(){j.revokeObjectURL(E)},4e4)}});l.saveAs=w.saveAs=w,c.exports=w})})(A);var I=A.exports;const D=B(I),H=i("label",{for:"checkbox"},"显示封面",-1),P=["src"],V=["onClick"],q=["onClick"],N=i("span",null,"作者：",-1),K=["src"],U="https://oiapi.net/API/Music_163",X=S({__name:"MyView1",setup(c){const p=_(""),v=_(!1),d=_([]),k=_(""),u=_(),l=async e=>{if(e.musicInfo){o(e.musicInfo.url);return}let t=await h(e.id);e.musicInfo=t,o(t.url)};async function h(e){let t=new URL(U);t.searchParams.append("id",e.toString());let s=(await fetch(t).then(f=>f.json())).data;if(s.length)return s[0];throw new Error("没有找到歌曲")}async function w(e){e.musicInfo||(e.musicInfo=await h(e.id));let t=e.musicInfo.url,a=t.substring(t.lastIndexOf(".")),s=n(e.name),f=n(e.singers[0].name);D.saveAs(t,s+"-"+f+a)}function n(e){if(!e)return"";const t=/[\\/:*?"<>|]/g;return e.replace(t,"")}function o(e){u.value.src=e,u.value.oncanplay=()=>{u.value.oncanplay=null,u.value.play()}}function r(){if(!p.value||!p.value.trim())return;let e=new URL(U);e.searchParams.append("name",p.value),fetch(e).then(t=>t.json()).then(t=>{d.value=t.data})}return(e,t)=>(m(),y("main",null,[x(i("input",{onKeyup:O(r,["enter"]),type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>p.value=a)},null,544),[[F,p.value]]),i("button",{onClick:r},"搜索"),i("div",null,[x(i("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a)},null,512),[[T,v.value]]),H]),i("div",null,[(m(!0),y(L,null,M(d.value,a=>(m(),y("div",{key:a.id},[v.value?(m(),y("img",{key:0,src:a.picurl,width:"100px",height:"100px",alt:"封面"},null,8,P)):C("",!0),i("span",null,R(a.name),1),i("a",{onClick:s=>l(a)},"播放",8,V),i("a",{onClick:s=>w(a)},"下载",8,q),N,(m(!0),y(L,null,M(a.singers,s=>(m(),y("span",{key:s.id},R(s.name),1))),128))]))),128))]),i("audio",{ref_key:"audio",ref:u,id:"audio",src:k.value,controls:""},null,8,K)]))}});export{X as default};
